'''FileObj = open('HJH_1996_2007.sbs','rb')  
try:  
    while True:  
        BytesRead=FileObj.read(struct.calcsize("=QI"))  
        if not BytesRead:  
                break  
        msgtime, msglen = struct.unpack("=QI",BytesRead)  
        print "msgtime:",msgtime," msglen:",msglen,  
        ByteMsg=FileObj.read(msglen)  
        msgpb = BaseMessage_pb2.basemessage()  
        msgpb.ParseFromString(ByteMsg)  
        print " msg:",msgpb.mPayload  
finally:  
        FileObj.close()
'''
import read_binary_file
import os
import numpy as np
from datainput_HJH_regional_detail import myfun

#import matplotlib.pyplot as plt

if __name__ == '__main__':

    f=os.getcwd()+'\\HJH_1996_2007.sbs'
    nrow= 230
    ncol= 320
    nsp= 48
    #p=myfun(np.array([8.525641025641025328e-01, 5.769230769230768857e-02, 7.051282051282051211e-02, 6.217948717948718063e-01, 5.769230769230768857e-02, 3.328051741088717264e-01, 2.010998712985565540e-01, 4.551282051282051211e-01, 3.397435897435897578e-01, 6.858974358974359031e-01, 5.833333333333332593e-01, 7.500000000000000000e-01, 4.487179487179487197e-02, 5.769230769230768857e-02, 1.217948717948717924e-01, 1.602564102564102422e-01, 2.628205128205128305e-01, 1.906282180955646832e-01, 2.115384615384615363e-01, 6.410256410256410034e-03, 1.346153846153846090e-01, 2.415032795092225681e-01, 3.141025641025640969e-01, 1.923076923076923184e-02, 2.884615384615384359e-01, 4.974754206194176298e-02, 4.490388013725166161e-01, 1.214029873133293802e-01, 6.253488699824526487e-01, 4.496729899697560207e-01, 6.410256410256410034e-03, 1.217948717948717924e-01, 1.217948717948717924e-01, 4.807692307692307265e-01, 2.680485862810294551e-02, 2.500000000000000000e-01, 7.628205128205127750e-01, 1.474358974358974395e-01 ]))
#    p=myfun(np.array([ 1.168936465700774752e-02, 2.778240844522407715e-01, 1.174394780306759478e-01, 7.795180153615418606e-01, 9.303348229532457103e-02,
#2.414494741488349416e-01, 1.154180519828464230e-01, 5.099773352943024474e-01, 6.297051960665809300e-01, 1.909209436103599389e-01,
#8.039052087167932736e-01, 5.665942700974276880e-01, 1.026111400537952911e-01, 4.111671402398285879e-01, 6.511835775599350562e-01,
#2.025426093713594278e-01, 4.640535065242098467e-01, 5.135737052770963373e-01, 5.073167170387488101e-01, 2.050374345579550617e-01,
#4.986163107332156619e-01, 7.594757179374239664e-02, 8.713504056831486433e-02, 1.921258736765289188e-01, 1.113125947227357193e-01,
#3.800967140386310450e-01, 4.112494770156716745e-02, 7.854715371674904079e-01, 3.606241920481823016e-01, 3.127308749799202481e-01,
#9.615217796830398678e-01, 4.963097575024165153e-01, 1.484226097457863880e-01, 8.391749750514021500e-01, 1.814665306005635304e-01,
#6.632510439212968567e-02, 9.821629341415751835e-01, 8.552264873303533355e-02 ]))
    p=myfun(np.array([1.168936e-02, 2.778241e-01, 1.174395e-01, 7.795180e-01, 9.303348e-02, 2.414495e-01, 1.154181e-01, 5.099773e-01,
6.297052e-01, 1.909209e-01, 8.039052e-01, 5.665943e-01, 1.026111e-01, 4.111671e-01, 6.511836e-01, 2.025426e-01,
4.640535e-01, 5.135737e-01, 5.073167e-01, 2.050374e-01, 4.986163e-01, 7.594757e-02, 8.713504e-02, 1.921259e-01,
1.113126e-01, 3.800967e-01, 4.112495e-02, 7.854715e-01, 3.606242e-01, 3.127309e-01, 9.615218e-01, 4.931535e-01,
1.484226e-01, 8.391750e-01, 1.814665e-01, 6.632510e-02, 9.821629e-01, 8.552265e-02]))
    result=read_binary_file.read_binary_file(f,nrow,ncol,nsp)
    #plt.imshow(result[-1])
    result1=np.flipud(result[-1])
    #result1[0,0]=0.7
    #plt.contourf(result1)
    #plt.colorbar()#ticks=[-0.1, 0.0, 0.1,0.2,0.3,0.4,0.5,0.6,0.7])
    #plt.show()
    #plt.savefig('DYCORS_HJH.png')

    
    #print p
    #print result.shape,np.max(result[0]),result[-1].shape,np.sum(result[-1]),np.max(result[-1])
